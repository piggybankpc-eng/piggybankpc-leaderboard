{% extends "base.html" %}

{% block title %}Download - PiggyBankPC Benchmark{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <!-- Header -->
            <div class="text-center mb-5">
                <h1 class="display-4">
                    <i class="bi bi-download"></i> Download PiggyBankPC Benchmark
                </h1>
                <p class="lead text-muted">
                    One-click AppImage installer for Linux. Test your hardware and join the leaderboard!
                </p>
            </div>

            <!-- NEW: Client Agent - Easy Setup -->
            <div class="card shadow-lg mb-4 border-success" style="border-width: 3px;">
                <div class="card-header bg-success text-white">
                    <h3 class="mb-0">
                        <i class="bi bi-rocket-takeoff"></i> ðŸš€ RECOMMENDED: One-Command Installation
                    </h3>
                </div>
                <div class="card-body">
                    <h5>Run This Simple Command on Your PC:</h5>
                    <p class="mb-3">
                        Our lightweight client agent will:
                    </p>
                    <ul class="mb-3">
                        <li>âœ… Automatically detect your hardware (CPU, GPU, RAM)</li>
                        <li>âœ… Check for required dependencies (Python, curl, etc.)</li>
                        <li>âœ… Download and install benchmark tools (Unigine Heaven, Ollama + LLM, Sysbench)</li>
                        <li>âœ… Download the benchmark AppImage</li>
                        <li>âœ… Run benchmarks locally on YOUR PC</li>
                        <li>âœ… Generate results file for upload</li>
                    </ul>

                    <div class="alert alert-dark alert-permanent mb-3">
                        <strong>ðŸ’» Linux Installation Commands:</strong>
                        <div class="bg-black text-white p-3 rounded mt-2 font-monospace" style="position: relative;">
                            <button class="btn btn-sm btn-outline-light position-absolute top-0 end-0 m-2"
                                    type="button"
                                    onclick="copyCommand('linux-commands')"
                                    style="z-index: 10;">
                                <i class="bi bi-clipboard"></i> Copy
                            </button>
                            <pre class="text-white mb-0" id="linux-commands" style="user-select: all;">curl -sL piggybankpc.uk/static/install-piggybankpc.sh -o install.sh
chmod +x install.sh
./install.sh</pre>
                        </div>
                        <small class="text-muted d-block mt-2">
                            <i class="bi bi-info-circle"></i> Downloads the installer, makes it executable, and runs it with interactive prompts for dependency installation.
                        </small>
                        <small class="text-muted d-block mt-1">Or download manually:</small>
                        <a href="{{ url_for('static', filename='install-piggybankpc.sh') }}" class="btn btn-sm btn-outline-light mt-2">
                            <i class="bi bi-download"></i> Download Installer Script
                        </a>
                    </div>

                    <div class="alert alert-info alert-permanent mb-0">
                        <i class="bi bi-info-circle"></i> <strong>How it works:</strong><br>
                        The client agent runs on YOUR computer (not our server), so it can accurately detect your hardware and run benchmarks locally. Results are saved to a .pbr file that you upload here.
                    </div>
                </div>
            </div>

            <script>
            function copyCommand(elementId) {
                var element = document.getElementById(elementId);
                var textToCopy = element.textContent || element.value;

                navigator.clipboard.writeText(textToCopy);

                // Visual feedback
                var btn = event.target;
                if (!btn.classList.contains('btn')) {
                    btn = btn.closest('button');
                }
                var originalText = btn.innerHTML;
                btn.innerHTML = '<i class="bi bi-check"></i> Copied!';
                setTimeout(function() {
                    btn.innerHTML = originalText;
                }, 2000);
            }
            </script>

            <!-- What's Included -->
            <div class="card shadow mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-info-circle"></i> What's Included?
                    </h5>
                </div>
                <div class="card-body">
                    <ul class="mb-0">
                        <li><strong>Gaming FPS Benchmark</strong> - Test real-world gaming performance using Unigine Heaven</li>
                        <li><strong>AI/LLM Benchmark</strong> - Measure tokens per second for AI workloads using Ollama</li>
                        <li><strong>CPU Benchmark</strong> - Comprehensive CPU performance testing using Sysbench</li>
                        <li><strong>GPU Diagnostics</strong> - Automatic hardware detection with nvidia-smi</li>
                        <li><strong>Encrypted Results</strong> - Tamper-proof .pbr file generation for leaderboard submission</li>
                    </ul>
                </div>
            </div>

            <!-- System Requirements -->
            <div class="card shadow mb-4">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">
                        <i class="bi bi-exclamation-triangle"></i> System Requirements
                    </h5>
                </div>
                <div class="card-body">
                    <ul class="mb-0">
                        <li><strong>OS:</strong> Ubuntu 22.04+ or compatible Linux distribution</li>
                        <li><strong>GPU:</strong> NVIDIA GPU with working drivers (nvidia-smi functional)</li>
                        <li><strong>RAM:</strong> 8GB minimum, 16GB recommended</li>
                        <li><strong>Storage:</strong> 5GB free space (for Unigine Heaven and Ollama downloads)</li>
                        <li><strong>Internet:</strong> Required for downloading dependencies and result submission</li>
                    </ul>
                </div>
            </div>

            <!-- Security Notice -->
            <div class="card shadow mb-4 border-danger">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-shield-check"></i> Security & Anti-Tampering
                    </h5>
                </div>
                <div class="card-body">
                    <p><strong>Why AppImage?</strong></p>
                    <p class="text-muted">
                        The benchmark is distributed as an AppImage to ensure result integrity. All benchmark results
                        are cryptographically signed and cannot be tampered with. This guarantees fair competition
                        on the leaderboard.
                    </p>
                    <p class="mb-0"><strong>What gets encrypted?</strong></p>
                    <ul class="text-muted mb-0">
                        <li>Hardware fingerprint (prevents duplicate submissions)</li>
                        <li>All benchmark scores (FPS, AI tokens/sec, CPU scores)</li>
                        <li>System information (GPU, CPU, RAM)</li>
                        <li>Timestamp and benchmark version</li>
                    </ul>
                </div>
            </div>

            <!-- GitHub & Support -->
            <div class="card shadow">
                <div class="card-body text-center">
                    <h5>Need Help?</h5>
                    <p class="text-muted">
                        Watch the tutorial video or join the community discussion
                    </p>
                    <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                        <a href="https://youtube.com/{{ config.YOUTUBE_CHANNEL }}"
                           target="_blank"
                           class="btn btn-danger">
                            <i class="bi bi-youtube"></i> Watch Tutorial
                        </a>
                        <a href="https://github.com/piggybankpc-eng"
                           target="_blank"
                           class="btn btn-outline-secondary">
                            <i class="bi bi-github"></i> GitHub
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
